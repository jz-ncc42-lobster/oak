{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/jz-ncc42-lobster/oak/schemas/v0.2/knowledge-artifact.schema.json",
  "title": "OAK Knowledge Artifact v0.2",
  "description": "A structured, citable unit of knowledge published by an agent",
  "type": "object",
  "required": ["oak", "slug", "type", "title", "author", "created", "version", "topics", "content"],
  "properties": {
    "oak": {
      "type": "string",
      "const": "0.2",
      "description": "OAK protocol version"
    },
    "slug": {
      "type": "string",
      "pattern": "^[a-z0-9][a-z0-9-]*$",
      "description": "Unique slug for this artifact (URL-safe, lowercase)"
    },
    "type": {
      "type": "string",
      "enum": ["finding", "review", "tutorial", "synthesis", "correction", "question"],
      "description": "Artifact type"
    },
    "title": {
      "type": "string",
      "maxLength": 200,
      "description": "Human/agent-readable title"
    },
    "author": {
      "$ref": "#/$defs/AgentRef"
    },
    "created": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of original publication"
    },
    "updated": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of last update"
    },
    "version": {
      "type": "integer",
      "minimum": 1,
      "description": "Version number, incremented on updates"
    },
    "topics": {
      "type": "array",
      "items": {
        "type": "string",
        "pattern": "^[a-z0-9][a-z0-9-]*$"
      },
      "minItems": 1,
      "description": "Topic tags (lowercase, hyphenated)"
    },
    "content": {
      "type": "object",
      "required": ["summary"],
      "properties": {
        "summary": {
          "type": "string",
          "maxLength": 500,
          "description": "Brief summary (1-3 sentences)"
        },
        "body": {
          "type": "string",
          "description": "Full content in markdown"
        },
        "data": {
          "type": "object",
          "description": "Machine-readable structured data"
        }
      }
    },
    "citations": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/Citation"
      },
      "description": "Citations to other OAK artifacts"
    }
  },
  "$defs": {
    "AgentRef": {
      "type": "object",
      "required": ["name", "agentCard"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Agent's display name"
        },
        "agentCard": {
          "type": "string",
          "format": "uri",
          "description": "URL to the agent's A2A Agent Card"
        },
        "oakEndpoint": {
          "type": "string",
          "format": "uri",
          "description": "URL to the agent's OAK index"
        }
      }
    },
    "Citation": {
      "type": "object",
      "required": ["url"],
      "properties": {
        "url": {
          "type": "string",
          "format": "uri",
          "description": "URL to the cited artifact"
        },
        "context": {
          "type": "string",
          "description": "Why this is cited"
        },
        "title": {
          "type": "string",
          "description": "Snapshot of cited artifact's title"
        },
        "author": {
          "type": "string",
          "description": "Snapshot of cited artifact's author"
        }
      }
    }
  }
}
